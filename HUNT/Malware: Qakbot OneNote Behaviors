title:  Qakbot OneNote Curl/Powershell > Oublic IPs and Dat files
description: QBOT behaviors
Kill Chain: Install/Exploit
date: 2/8/2023
operating_system: Windows
author: B-Rad 
query: SrcProcCmdLine  RegExp "\b(?!(10)|192\.168|172\.(2[0-9]|1[6-9]|3[0-1])|(25[6-9]|2[6-9][0-9]|[3-9][0-9][0-9]|99[1-9]))[0-9]{1,3}\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)" AND SrcProcCmdLine EndsWith Anycase "dat"
XDR: dst.ip.address matches '^(?!192\.168\.)' dst.ip.address matches '^(?!127\.)' dst.ip.address matches '^(?!10\.)' dst.ip.address matches '^(?!172\.1[6-9]\.)' dst.ip.address matches '^(?!172\.2[0-9]\.)' dst.ip.address matches '^(?!172\.3[0-1]\.)' AND src.process.cmdline contains 'curl'
| columns src.process.storyline.id , event.time , event.type , event.category , src.process.cmdline , event.dns.request , event.dns.response,  dst.ip.address,  src.ip.address  
